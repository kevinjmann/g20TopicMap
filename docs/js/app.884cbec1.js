(function(t){function e(e){for(var r,o,c=e[0],l=e[1],s=e[2],p=0,d=[];p<c.length;p++)o=c[p],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&d.push(n[o][0]),n[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);u&&u(e);while(d.length)d.shift()();return i.push.apply(i,s||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],r=!0,c=1;c<a.length;c++){var l=a[c];0!==n[l]&&(r=!1)}r&&(i.splice(e--,1),t=o(o.s=a[0]))}return t}var r={},n={app:0},i=[];function o(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=r,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(a,r,function(e){return t[e]}.bind(null,r));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/g20TopicMap/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var s=0;s<c.length;s++)e(c[s]);var u=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var r=a("85ec"),n=a.n(r);n.a},"17f2":function(t,e,a){"use strict";var r=a("9a00"),n=a.n(r);n.a},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r,n=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("Main")],1)},o=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"pos-f-t mainMapContainer"},[a("div",{staticClass:"navbar-collapse collapse show",attrs:{id:"navbarToggleExternalContent"}},[a("div",{staticClass:"bg-dark p-4"},[a("svg",{ref:"mainMap",attrs:{viewBox:"0 0 1500 900",width:"1500",height:"auto",preserveAspectRatio:"xMidYMid"}})])]),a("nav",{staticClass:"navbar navbar-dark bg-dark"},[a("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarToggleExternalContent","aria-controls":"navbarToggleExternalContent","aria-expanded":"false","aria-label":"Toggle navigation",visibility:"hidden"},on:{click:t.handleCollapse}},[a("span",{staticClass:"navbar-toggler-icon"})]),a("div",{ref:"miniPicContainer"})])]),t._m(0),t._m(1)])},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("br"),a("br"),a("br")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card"},[a("div",{staticClass:"card-header"},[a("h5",[t._v("Drag and drop cards")])]),a("div",{staticClass:"card-block"},[a("div",{staticClass:"row",attrs:{id:"sortable"}})])])}],s=(a("99af"),a("4160"),a("caad"),a("c975"),a("a434"),a("b0c0"),a("b64b"),a("159b"),a("d3b7"),a("3ca3"),a("ddb0"),a("3835")),u=a("5698"),p=a("3fe2"),d=function(){return Promise.all([u["g"]("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json"),u["g"]("/g20TopicMap/countryTopics.json")]).then((function(t){var e=Object(s["a"])(t,2),a=e[0],r=e[1],n=p["a"](a,a.objects.countries);return n.features.forEach((function(t){r[t.properties.name]&&(t.topics=r[t.properties.name],t.curTopicIdx=0)})),n}))},f=(a("a15b"),a("ac1f"),a("1276"),a("2ca0"),a("498a"),function(t,e){var a=e.topicData,r=e.path;t.raise();var n=function(t,e,a){if(e=e.trim(),t.attr("fill","none").attr("stroke","white"),e.startsWith("M 0 0")){for(var r,n="M 0 0",i=e.split(" L "),c=0,l=1;l<i.length;l++)r=i[l].split(" "),t.transition().delay(c).duration(a).attrTween("d",o(n,r)),n+=" L "+i[l],c+=a;return{delay:c,endPos:r}}console.log("path needs to start from origin M 0 0")},i=function(t,e,r){var i=n(t.append("path"),e,r),o=i.delay,c=i.endPos;t.append("text").text(a).attr("opacity",0).attr("fill","white").attr("x",c[0]).attr("y",c[1]).attr("text-anchor",c[0]>0?"start":"end").transition().delay(o).duration(r).attr("opacity",1)},o=function(t,e){return function(){var a=t.split("L"),r=a[a.length-1],n=r.split(" "),i=[n[n.length-2],n[n.length-1]],o=i[0],c=i[1],l=e[0],s=e[1],p=u["e"]([o,c],[l,s]);return function(e){return e<1?"".concat(t," L ")+p(e).join(" "):"".concat(t," L  ").concat(l," ").concat(s)}}};t.selectAll("path").remove(),t.selectAll("text").remove(),t.selectAll("rect").remove();var c=t.append("g"),l=r;i(c,l,1e3)}),h=a("1157"),v=a.n(h);a("3ff8"),a("ccf8"),a("1859"),a("7cf7"),a("83ef"),a("36fa"),a("4c72");function m(){for(var t,e,a,n=u["h"]("svg"),i=parseFloat(n.attr("width")),o=.6,c=i*o,l=n.append("text").text("click to start").attr("fill","white").attr("x",i/2).attr("text-anchor","middle").attr("y",15).attr("font-size","1.3em"),s=.015,p=200,h=50,v=u["b"]().scale(c/2.5).translate([i/2,c/2]),m=v,b=u["a"]().translate([i/2,c/2]).scale(c/10),g=0,y=u["c"]().projection(m),x=[300,600],C=!1,M=!1,w=function(t,e,a){return(t-e)*(t-a)<=0},A=["Australia","Canada","Saudi Arabia","United States of America","India","Russia","South Africa","Turkey","Argentina","Brazil","Mexico","France","Germany","Italy","United Kingdom","China","Indonesia","Japan","South Korea","Spain"],E=[["M 0 0 L -10 -10 L -60 -10",[-60,-10]],["M 0 0 L 10 -10 L 60 -10",[60,-10]],["M 0 0 L 10 10 L 60 10",[60,10]],["M 0 0 L -10 10 L -60 10",[-60,10]]],j=[],k=n.append("g"),T=[],P=0;P<10;P++){var _=k.append("g");T.push(_)}var O=[];k.append("path").attr("d",y({type:"Sphere"})).attr("class","horizon");var S,L=null,I=[],$=k.append("g"),B=function(t,e){var a=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(a*a+r*r)},z=function t(){var n=k.selectAll("path").data(e),i=function(t){return u["f"](t)},o=n.enter().append("g");if(L)if(y.area(L)>a){var c=y.centroid(L);$.attr("visibility","visible").attr("transform","translate(".concat(c[0],",").concat(c[1],")"))}else $.attr("visibility","hidden");o.append("path").attr("class","countries").merge(n).attr("d",y).attr("fill",(function(t,a){return I.includes(t)?i(a/e.length):A.includes(t.properties.name)?"grey":"darkgrey"})).on("click",(function(e){if(C){if(L=e,!A.includes(L.properties.name))return;var a=document.getElementById("sortable");I.includes(e)?(I.splice(I.indexOf(e),1),r.ldaElsByCountry[e.properties.name].forEach((function(t){a.removeChild(t)}))):(I.push(e),r.ldaElsByCountry[e.properties.name].forEach((function(t){a.appendChild(t)}))),t()}})),o.append("svg:title").text((function(t){return t.properties.name}));for(var l=[],s=0;s<O.length;s++){var d=O[s];if(d[2]<=0)d[0].selectAll("path").remove(),d[0].selectAll("text").remove(),l.push(s);else{var v=void 0,m=void 0;"France"===d[1].properties.name?(v=y.centroid(S),m=y.area(S)):(v=y.centroid(d[1]),m=y.area(d[1])),d[0]&&(m>d[3]?(d[0].attr("visibility","visible"),d[0].attr("transform","translate(".concat(v[0],",").concat(v[1],")"))):d[0].attr("visibility","hidden")),d[2]--}}if(l.reverse().forEach((function(t){T.push(O[t][0]),O.splice(t,1)})),!C&&T.length>0)for(var b=0;b<j.length;b++){var g,P=j[b];if("France"===P.properties.name?(M||(S={type:"Polygon",coordinates:[P.geometry.coordinates[1][0]]},M=!0),g=y.centroid(S)):g=y.centroid(P),w(g[0],x[0],x[1])&&Math.random()>.9){if(!(T.length>0))break;var _=!1,z=void 0;if(O.length>0?function(){var t=[];if(O.forEach((function(e){var a=y.centroid(e[1]),r=e[4],n=[a[0]+r[0],a[1]+r[1]];w(n[0],g[0]-80,g[0]+80)&&w(n[1],g[1]-25,g[1]+25)&&t.push(n)})),t.length>0){for(var e=0;e<E.length;e++){for(var a=0,r=E[e][1],n=[r[0]+g[0],r[1]+g[1]],i=!0,o=0;o<t.length;o++)if(a=B(t[o],n),a<h){i=!1;break}if(i){z=E[e];break}}z||(_=!0)}else z=E[Math.floor(Math.random()*E.length)]}():z=E[Math.floor(Math.random()*E.length)],!_){var F=T.pop();F.attr("transform","translate(".concat(g[0],",").concat(g[1],")")),F.call(f,{topicData:P.topics[P.curTopicIdx],path:z[0]}),P.curTopicIdx++,P.curTopicIdx%=P.topics.length;var D=void 0;D="France"===P.properties.name?y.area(S)/10:y.area(P)/10,O.push([F,P,p,D,z[1]])}}}};function F(){var e;C||(l.attr("stroke","none"),L=null,e=b,g=1,O.forEach((function(t){t[0].select("g").selectAll("path").remove(),t[0].select("g").selectAll("text").remove()})),$.selectAll("g").selectAll("text").remove(),$.selectAll("g").selectAll("path").remove(),T=null,O=[],n.selectAll("text").remove(),t.stop(),n.selectAll("path").transition().duration(1e3).attrTween("d",(function(t){var e=m.scale(),a=c/4,r=u["e"](m.rotate(),[0,0,0]),n=u["e"](e,a);return function(i){return m.rotate(r(Math.pow(i,.33))).scale(n(e>a?Math.pow(i,.1):Math.pow(i,3))),y.projection(m),1===i&&(1===g?m=b:0===g&&(m=v),y.projection(m)),y(t)}})).transition().duration(1e3).attrTween("d",D(m,e)),y=u["c"]().projection(e),C=!0,n.transition().duration(1e3).attr("width",900),n.append("text").text("Click one of the available countries to see the topic models").attr("fill","white").attr("x",i/2).attr("y",30).attr("text-anchor","middle").attr("font-size","2em"))}function D(t,e){return function(a){var r=0,n=u["d"](o).scale(1).translate(t.translate()),i=u["c"](n);function o(a,n){a*=180/Math.PI,n*=180/Math.PI;var i=t([a,n]),o=e([a,n]);return[(1-r)*i[0]+r*o[0],(1-r)*-i[1]+r*-o[1]]}return function(t){return r=t,i(a)?i(a):"M 0 0"}}}d().then((function(a){a.features.forEach((function(t){A.includes(t.properties.name)&&j.push(t)})),e=a.features,t=u["i"]((function(t){m.rotate([s*t]),z()}))})),document.querySelector("svg").onclick=F}var b={data:function(){return{ldaElsByCountry:{}}},mounted:function(){var t=this;r=this,m(),v()("#sortable").sortable(),v()("#sortable").disableSelection(),u["g"]("/g20TopicMap/visualizationPathsByCountry.json").then((function(e){var a=Object.keys(e);a.forEach((function(a){t.ldaElsByCountry[a]=[],e[a].forEach((function(e){var r=document.createElement("div");r.setAttribute("class","col-xxl-6");var n=document.createElement("div");n.setAttribute("class","card-sub");var i=document.createElement("div");i.setAttribute("class","embed-responsive embed-responsive-4by3 myCard");var o=document.createElement("iframe");o.setAttribute("scrolling","no"),o.setAttribute("frameborder","0"),o.setAttribute("class","lda-vis"),o.setAttribute("src","/g20TopicMap/"+e),i.appendChild(o),n.appendChild(i),r.appendChild(n),t.ldaElsByCountry[a].push(r)}))}))}))},methods:{handleCollapse:function(){var t=this.$refs.mainMap.cloneNode(!0);while(this.$refs.miniPicContainer.lastChild)this.$refs.miniPicContainer.removeChild(this.$refs.miniPicContainer.lastChild);t.setAttribute("class","miniSvg"),this.$refs.miniPicContainer.appendChild(t)}}},g=b,y=(a("17f2"),a("2877")),x=Object(y["a"])(g,c,l,!1,null,null,null),C=x.exports,M={name:"App",components:{Main:C}},w=M,A=(a("034f"),Object(y["a"])(w,i,o,!1,null,null,null)),E=A.exports;a("4989"),a("ab8b");n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(E)}}).$mount("#app")},"85ec":function(t,e,a){},"9a00":function(t,e,a){}});
//# sourceMappingURL=app.884cbec1.js.map